CREATE TABLE SALESMAN(
SALESMAN_ID INT PRIMARY KEY,
NAME VARCHAR(255),
CITY VARCHAR(255),
COMMISSION VARCHAR(255)
);


CREATE TABLE COUSTOMER(
CUSTOMER_ID INT PRIMARY KEY,
CUST_NAME VARCHAR(255),
CITY VARCHAR(255),
GRADE INT,
SALESMAN_ID INT,
FOREIGN KEY (SALESMAN_ID) REFERENCES SALESMAN(SALESMAN_ID)ON DELETE CASCADE
);


CREATE TABLE ORDERS(
ORD_NO INT PRIMARY KEY,
PURCHASE_AMT INT,
ORD_DATE DATE,
CUSTOMER_ID INT,
SALESMAN_ID INT,
FOREIGN KEY (CUSTOMER_ID)REFERENCES COUSTOMER(CUSTOMER_ID)ON DELETE CASCADE,
FOREIGN KEY (SALESMAN_ID)REFERENCES SALESMAN(SALESMAN_ID)ON DELETE CASCADE
);


INSERT INTO SALESMAN(SALESMAN_ID,NAME,CITY,COMMISSION)
VALUES
(1,'JHON DOE','BANGALORE','10%'),
(2,'JANE SMITH','MUMBAI','12%'),
(5,'CHARLIE WILSON','MUMBAI','10%');


INSERT INTO COUSTOMER(CUSTOMER_ID,CUST_NAME,CITY,GRADE,SALESMAN_ID)
VALUES
(101,'CUSTOMER1','BANGLORE',5,1),
(102,'CUSTOMER2','MUMBAI',8,2),
(105,'CUSTOMER5','MUMBAI',9,5);

INSERT INTO ORDERS(ORD_NO,PURCHASE_AMT,ORD_DATE,CUSTOMER_ID,SALESMAN_ID)
VALUES
(1001,500,'2023-01-01',101,1),
(1002,700,'2023-01-02',102,2),
(1005,600,'2023-01-02',105,5);





SELECT GRADE,COUNT(DISTINCT CUSTOMER_ID)
FROM COUSTOMER
GROUP BY GRADE
HAVING GRADE>(SELECT AVG(GRADE)
FROM COUSTOMER
WHERE CITY ='BANGLORE');



SELECT SALESMAN_ID ,NAME
FROM SALESMAN A
WHERE 1<(
SELECT COUNT(*)
FROM COUSTOMER
WHERE SALESMAN_ID =A.SALESMAN_ID
);



SELECT SALESMAN.SALESMAN_ID,NAME,CUST_NAME,
COMMISSION FROM SALESMAN , COUSTOMER
WHERE SALESMAN.CITY=COUSTOMER.CITY UNION
SELECT SALESMAN_ID,NAME,'NO MATCH',
COMMISSION FROM SALESMAN
WHERE NOT CITY =
ANY (SELECT CITY
FROM COUSTOMER)
ORDER BY 2 DESC;


CREATE VIEW ELITSALESMAN AS
SELECT B.ORD_DATE,A.SALESMAN_ID,
A.NAME FROM SALESMAN A, ORDERS B
WHERE A.SALESMAN_ID = B.SALESMAN_ID
AND B.PURCHASE_AMT=(SELECT MAX(PURCHASE_AMT)FROM ORDERS C
WHERE C.ORD_DATE=B.ORD_DATE);
SELECT* FROM ELITSALESMAN;


DELETE FROM SALESMAN WHERE SALESMAN_ID=5;
SELECT*FROM SALESMAN;