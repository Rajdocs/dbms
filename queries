-- Query 1
SELECT B.BOOK_ID, B.TITLE, B.PUBLISHER_NAME, BA.AUTHOR_NAME, BC.NO_OF_COPIES, LP.PROGRAMME_ID
FROM BOOK B
JOIN BOOK_AUTHORS BA ON B.BOOK_ID = BA.BOOK_ID
JOIN BOOK_COPIES BC ON B.BOOK_ID = BC.BOOK_ID
JOIN LIBRARY_PROGRAMME LP ON BC.PROGRAMME_ID = LP.PROGRAMME_ID;

-- Query 2
SELECT CARD_NO
FROM BOOK_LENDING
WHERE DATE_OUT BETWEEN '2017-01-01' AND '2017-07-30'
GROUP BY CARD_NO
HAVING COUNT(*) > 1;

-- Query 3
DELETE FROM BOOK WHERE Book_id = 4;

-- Query 4
SELECT * FROM BOOK;

-- Query 5
CREATE VIEW V_PUBLICATION AS
SELECT PUB_YEAR
FROM BOOK;

SELECT * FROM V_PUBLICATION;

-- Query 6
CREATE VIEW V_BOOKS AS
SELECT B.BOOK_ID, B.TITLE, BC.NO_OF_COPIES
FROM BOOK B, BOOK_COPIES BC, LIBRARY_PROGRAMME LP
WHERE B.BOOK_ID = BC.BOOK_ID
AND BC.PROGRAMME_ID = LP.PROGRAMME_ID;

SELECT * FROM V_BOOKS;
